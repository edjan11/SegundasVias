<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2 via obito</title>
  <link rel="stylesheet" href="../styles/base.css" />
  <link rel="stylesheet" href="../styles/layout.css" />
  <link rel="stylesheet" href="../styles/components.css" />
</head>
<body class="page-obito">
  <script>
    // Redirect to Base2ViaLayout to ensure single, consistent initialization
    (function() {
      if (!location.pathname.endsWith('Base2ViaLayout.html')) {
        const url = new URL('/ui/pages/Base2ViaLayout.html', location.origin);
        url.searchParams.set('act', 'obito');
        location.replace(url);
      }
    })();
  </script>
  <div class="app-shell">
    <div class="main-pane">
      <div class="container">
    <div class="toolbar">
      <div class="toolbar-left">
        <div class="app-title">2ª Via de Certidão</div>
        <div class="ato-picker">
          <label class="label" for="ato-select">Ato</label>
          <select id="ato-select" class="ato-select">
            <option value="nascimento">Nascimento</option>
            <option value="casamento">Casamento</option>
            <option value="obito">Obito</option>
          </select>
        </div>
      </div>
      <div class="toolbar-right">
        <button id="drawer-toggle" class="btn secondary">Painel</button>
        <div style="display:inline-flex; gap:6px; align-items:center; margin-left:8px;">
          <button id="btn-json" class="btn json compact" title="Gerar JSON">JSON</button>
          <button id="btn-xml" class="btn xml compact" title="Exportar XML">XML</button>
          <button id="btn-print" class="btn pdf compact" title="Imprimir PDF">PDF</button>
        </div>
      </div>
    </div>

    <form id="form-obito">
  <!-- Anti-autofill honeypot (consumes browser autofill) -->
  <div class="no-autofill-honeypot" aria-hidden="true">
    <input autocomplete="username" name="no_autofill_username" tabindex="-1" />
    <input type="password" autocomplete="new-password" name="no_autofill_password" tabindex="-1" />
    <input autocomplete="address-line1" name="no_autofill_addr1" tabindex="-1" />
    <input autocomplete="address-line2" name="no_autofill_addr2" tabindex="-1" />
    <input autocomplete="postal-code" name="no_autofill_postal" tabindex="-1" />
    <input autocomplete="country" name="no_autofill_country" tabindex="-1" />
  </div>
  <input type="hidden" name="idObitoNascidoVivo" value="" />
  <input type="hidden" name="operacao" value="NOVO" />
  <input type="hidden" name="tituloLivro" value="9º OFÍCIO DA COMARCA DE ARACAJU" />
  <input type="hidden" name="idCartorio" value="263" />

  <div class="card">

    <!-- 1) REGISTRO (o que o operador mais confere) -->
    <div class="section">
      <div class="subTitulo">Registro (Livro / Assinante / Matrícula)</div>
      <div class="grid">
        <div class="campo span-3">
          <label class="label">Data do termo <span class="obrigatorio">*</span></label>
          <input data-bind="registro.data_registro" name="dataTermo" placeholder="DD/MM/AAAA" inputmode="tel" maxlength="10" autocomplete="off" data-date data-required />
        </div>

        <div class="campo span-3">
          <label class="label">Nº Declaração</label>
          <input name="numDeclaracao" maxlength="12" />
        </div>

        <div class="campo span-2">
          <label class="label">Cartório (ofício)</label>
          <select data-bind="ui.cartorio_oficio" id="cartorio-oficio" class="w-cartorio">
            <option></option>
            <option value="6">6</option>
            <option value="9">9</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
          </select>
        </div>

        <div class="campo span-2">
          <label class="label">Livro <span class="obrigatorio">*</span></label>
          <input data-bind="ui.matricula_livro" name="livro" maxlength="5" inputmode="numeric" data-required />
        </div>

        <div class="campo span-2">
          <label class="label">Folha <span class="obrigatorio">*</span></label>
          <input data-bind="ui.matricula_folha" name="folha" maxlength="3" inputmode="numeric" data-required />
        </div>
        
        <div class="campo span-2">
          <label class="label">Termo <span class="obrigatorio">*</span></label>
          <input data-bind="ui.matricula_termo" name="termo" maxlength="7" inputmode="numeric" data-required />
        </div>

        <div class="campo span-6">
          <label class="label">Matrícula (gerada)</label>
          <input id="matricula" data-bind="registro.matricula" readonly />
        </div>

        <!-- Assinante agora posicionado à direita da matrícula -->
        <div class="campo span-4">
          <label class="label">Assinante <span class="obrigatorio">*</span></label>
          <select name="idAssinante" data-required data-signer-select></select>
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 2) IDENTIFICAÇÃO DO FALECIDO -->
    <div class="section">
      <div class="subTitulo">Identificação do falecido</div>
      <div class="grid">
        <div class="campo span-6">
          <label class="label">Falecido(a) <span class="obrigatorio">*</span></label>
          <input name="nomePessoa" maxlength="100" data-name-validate data-required />
        </div>

        <div class="campo span-3">
          <label class="label">Sexo <span class="obrigatorio">*</span></label>
          <select name="sexo" data-required>
            <option value=""></option>
            <option value="M">MASCULINO</option>
            <option value="F">FEMININO</option>
            <option value="I">IGNORADO</option>
            <option value="N">NÃO-BINÁRIO</option>
          </select>
        </div>

        <div class="campo span-3">
          <label class="label">Data nasc. <span class="obrigatorio">*</span></label>
          <input name="dataNascimento" placeholder="DD/MM/AAAA" inputmode="tel" maxlength="10" autocomplete="off" data-date data-required />
        </div>

          <div class="campo span-5">
            <label class="label">CPF</label>
            <div class="field-line">
              <input data-bind="registro.cpf" name="CPFPessoa" maxlength="14" inputmode="numeric" data-cpf />
              <label class="inline-check inline-check--compact cpf-toggle" for="cpf-falecido-ign">
                <span>Ignorar</span>
                <input type="checkbox" id="cpf-falecido-ign" />
              </label>
            </div>
          </div>

        <div class="campo span-7">
          <label class="label">Documento <span class="obrigatorio">*</span></label>
          <input name="documento" maxlength="230" data-required />
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 3) INFORMAÇÕES CIVIS -->
    <div class="section">
      <div class="subTitulo">Informações civis</div>
      <div class="grid">
        <div class="campo span-3">
          <label class="label">Nacionalidade</label>
          <input name="nacionalidade" data-default="BRASILEIRO" class="input-locked" />
        </div>

        <div class="campo span-3">
          <label class="label">Cor</label>
          <input name="cor" maxlength="20" />
        </div>

        <div class="campo span-3">
          <label class="label">Estado civil <span class="obrigatorio">*</span></label>
          <select name="estadoCivil" data-required>
            <option value=""></option>
            <option value="SJ">SEPARADO(A) JUDICIALMENTE</option>
            <option value="CA">CASADO(A)</option>
            <option value="DE">DESQUITADO(A)</option>
            <option value="DI">DIVORCIADO(A)</option>
            <option value="SO">SOLTEIRO(A)</option>
            <option value="VI">VIÚVO(A)</option>
            <option value="IG">IGNORADO</option>
          </select>
        </div>

        <div class="campo span-3">
          <label class="label">Idade e tipo</label>
          <input name="idade" maxlength="20" />
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 4) EVENTO DO ÓBITO -->
    <div class="section">
      <div class="subTitulo">Evento do óbito</div>
      <div class="grid">
        <div class="campo span-4">
          <label class="label">Cidade de nascimento <span class="obrigatorio">*</span></label>
          <input name="cidadeNascimento" maxlength="200" data-required autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
        </div>

        <div class="campo span-2">
          <label class="label">UF <span class="obrigatorio">*</span></label>
          <select name="ufNascimento" data-required autocomplete="nope" spellcheck="false">
            <option value=""></option>
            <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option>
            <option value="BA">BA</option><option value="BR">BR</option><option value="CE">CE</option><option value="DF">DF</option>
            <option value="ES">ES</option><option value="ET">ET</option><option value="GO">GO</option><option value="IG">IG</option>
            <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option>
            <option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option>
            <option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
            <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP">SP</option>
            <option value="SE">SE</option><option value="TO">TO</option>
          </select>
        </div>

        <div class="campo span-3">
          <label class="label">Data do óbito</label>
          <input name="dataObito" maxlength="10" class="campo campo_data" autocomplete="off" data-date />
        </div>

        <div class="campo span-2">
          <label class="label">Hora</label>
          <input name="horaObito" maxlength="5" class="campo campo_hora" autocomplete="off" data-time />
        </div>

        <div class="campo span-1">
          <label class="label">Eleitor <span class="obrigatorio">*</span></label>
          <select name="eleitor" data-required>
            <option value=""></option>
            <option value="S">SIM</option>
            <option value="N">NÃO</option>
            <option value="I">IGNORADO</option>
          </select>
        </div>

        <div class="campo span-12">
          <label class="label">Causa do óbito <span class="obrigatorio">*</span></label>
          <input name="causaObito" maxlength="1000" data-required />
        </div>

        <div class="campo span-6">
          <label class="label">Médico</label>
          <input name="nomeMedico" maxlength="70" data-name-validate />
        </div>

        <div class="campo span-6">
          <label class="label">CRM</label>
          <input name="crm" maxlength="7" />
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 5) LOCAL E SEPULTAMENTO -->
    <div class="section">
      <div class="subTitulo">Local e sepultamento</div>
      <div class="grid">
        <div class="campo span-3">
          <label class="label">Local do óbito <span class="obrigatorio">*</span></label>
          <select name="localObito" data-required>
            <option value=""></option>
            <option value="H">HOSPITAL</option>
            <option value="S">OUTROS ESTABELECIMENTOS DE SAÚDE SEM INTERNAÇÃO</option>
            <option value="D">DOMICÍLIO</option>
            <option value="V">VIA PÚBLICA</option>
            <option value="O">OUTROS</option>
            <option value="I">IGNORADO</option>
          </select>
        </div>

        <div class="campo span-5">
          <label class="label">Descrição do local <span class="obrigatorio">*</span></label>
          <input name="descricaoLocalObito" maxlength="150" data-required />
        </div>
        <div class="campo span-3">
          <label class="label">Cidade do óbito <span class="obrigatorio">*</span></label>
          <input name="municipioObito" maxlength="50" data-required autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
        </div>

        <div class="campo span-1">
          <label class="label">UF <span class="obrigatorio">*</span></label>
          <select name="ufMunicipioObito" id="ufMunicipioObito" data-required autocomplete="nope" spellcheck="false">
            <option value=""></option>
            <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option>
            <option value="BA">BA</option><option value="BR">BR</option><option value="CE">CE</option><option value="DF">DF</option>
            <option value="ES">ES</option><option value="ET">ET</option><option value="GO">GO</option><option value="IG">IG</option>
            <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option>
            <option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option>
            <option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
            <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP">SP</option>
            <option value="SE">SE</option><option value="TO">TO</option>
          </select>
        </div>

        <div class="campo span-6">
          <label class="label">Local do sepultamento</label>
          <input name="sepultamento" maxlength="300" autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
        </div>
        <div class="campo span-4">
          <label class="label">Cidade sepultamento <span class="obrigatorio">*</span></label>
          <input name="municipioSepultamento" maxlength="300" data-required autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
        </div>

        <div class="campo span-2">
          <label class="label">UF <span class="obrigatorio">*</span></label>
          <select name="ufMunicipioSepultamento" id="ufMunicipioSepultamento" data-required autocomplete="nope" spellcheck="false">
            <option value=""></option>
            <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option>
            <option value="BA">BA</option><option value="BR">BR</option><option value="CE">CE</option><option value="DF">DF</option>
            <option value="ES">ES</option><option value="ET">ET</option><option value="GO">GO</option><option value="IG">IG</option>
            <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option>
            <option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option>
            <option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
            <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP">SP</option>
            <option value="SE">SE</option><option value="TO">TO</option>
          </select>
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 6) FAMÍLIA -->
    <div class="section">
      <div class="subTitulo">Família</div>
      <div class="grid">
        <div class="campo span-6">
          <label class="label">Nome da mãe</label>
          <input name="nomeMae" maxlength="70" data-name-validate />
        </div>
        <div class="campo span-6">
          <label class="label">Nome do pai</label>
          <input name="nomePai" maxlength="70" data-name-validate />
        </div>

        <div class="campo span-8">
          <label class="label">Cônjuge</label>
          <input name="conjuge" maxlength="1000" data-name-validate />
        </div>

        <div class="campo span-4">
          <label class="label">Bens</label>
          <select name="flagBens" id="flagBens">
            <option value=""></option>
            <option value="S">SIM</option>
            <option value="N">NÃO</option>
          </select>
        </div>

        <div class="campo span-12">
          <label class="label">Filhos</label>
          <textarea name="descricaoFilhos" maxlength="500"></textarea>
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 7) DECLARANTE / ENDEREÇO / OBS -->
    <div class="section">
      <div class="subTitulo">Endereço e declarante</div>
      <div class="grid">
        <div class="campo span-8">
          <label class="label">Endereço</label>
          <input name="endereco" maxlength="200" autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
        </div>
        <div class="campo span-4">
          <label class="label">Declarante <span class="obrigatorio">*</span></label>
          <input name="declarante" maxlength="70" data-name-validate data-required />
        </div>
        <div class="campo span-12">
          <label class="label">Observações / Averbações</label>
          <textarea name="observacaoCertidao"></textarea>
        </div>
      </div>
    </div>

    <div class="section-divider"></div>

    <!-- 8) DOCUMENTOS E EXTRAS (UNIFICADO, sem duplicidade de name=) -->
    <details class="collapse">
      <summary>Documentos e extras</summary>
      <div class="subcard">
        <div class="grid">
          <div class="campo span-3">
            <label class="label">RG</label>
            <input name="numeroRG" maxlength="10" />
          </div>
          <div class="campo span-3">
            <label class="label">Data Expedição</label>
            <input name="dataExpedicaoRG" maxlength="10" class="campo campo_data" autocomplete="off" data-date />
          </div>
          <div class="campo span-6">
            <label class="label">Órgão Expedidor</label>
            <select name="idOrgaoExpedidorRG" id="orgaoExpedidorRG"></select>
          </div>
          <div class="campo span-3">
            <label class="label">Data Validade</label>
            <input name="dataValidadeRG" maxlength="10" class="campo campo_data somenteLeitura" readonly />
          </div>

          <div class="campo span-3">
            <label class="label">PIS</label>
            <input name="numeroPIS" maxlength="11" />
          </div>
          <div class="campo span-3">
            <label class="label">Data Expedição PIS</label>
            <input name="dataExpedicaoPIS" maxlength="10" class="campo campo_data" data-date />
          </div>
          <div class="campo span-6">
            <label class="label">Órgão Expedidor PIS</label>
            <select name="idOrgaoExpedidorPIS" id="orgaoExpedidorPIS"></select>
          </div>

          <div class="campo span-3">
            <label class="label">Passaporte</label>
            <input name="numeroPassaporte" maxlength="10" />
          </div>
          <div class="campo span-3">
            <label class="label">Data Expedição Passaporte</label>
            <input name="dataExpedicaoPassaporte" maxlength="10" class="campo campo_data" data-date />
          </div>
          <div class="campo span-6">
            <label class="label">Órgão Expedidor Passaporte</label>
            <select name="idOrgaoExpedidorPassaporte" id="orgaoExpedidorPassaporte"></select>
          </div>

          <div class="campo span-3">
            <label class="label">CNS</label>
            <input name="numeroCNS" maxlength="15" />
          </div>
          <div class="campo span-3">
            <label class="label">Data Expedição CNS</label>
            <input name="dataExpedicaoCNS" maxlength="10" class="campo campo_data somenteLeitura" readonly />
          </div>
          <div class="campo span-6">
            <label class="label">Órgão Expedidor CNS</label>
            <select name="idOrgaoExpedidorCNS" id="orgaoExpedidorCNS"></select>
          </div>

          <div class="campo span-3">
            <label class="label">Título de Eleitor</label>
            <input name="numeroTitulo" maxlength="12" />
          </div>
          <div class="campo span-3">
            <label class="label">Zona / Seção</label>
            <input name="zonaTitulo" maxlength="20" />
          </div>
          <div class="campo span-2">
            <label class="label">UF Título</label>
            <select name="ufTitulo" id="ufTitulo"></select>
          </div>
          <div class="campo span-4">
            <label class="label">Município Título</label>
            <input name="cidadeTitulo" maxlength="30" />
          </div>

          <div class="campo span-3">
            <label class="label">CEP</label>
            <input name="CEP" maxlength="8" autocomplete="nope" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </div>
          <div class="campo span-3">
            <label class="label">Grupo Sanguíneo</label>
            <input name="grupoSanguineo" maxlength="3" />
          </div>
        </div>
      </div>
    </details>

    <!-- 9) FINANCEIRO -->
    <div style="margin-top:12px;" class="grid">
      <div class="campo span-3">
        <label class="label">Formato casa da moeda?</label>
        <select name="moeda">
          <option value="0">NÃO</option>
          <option value="1">SIM</option>
        </select>
      </div>
      <div class="campo span-3">
        <label class="label">Pagou emolumentos?</label>
        <select name="pagouEmolumentos">
          <option value=""></option>
          <option value="N">NÃO</option>
          <option value="S">SIM</option>
        </select>
      </div>
    </div>

  </div>
</form>

      </div>
    </div>

    <div id="panel-inline"></div>

    <div class="ops-pane" id="ops-pane" aria-hidden="true">
      <div class="ops-header">
        <div class="ops-title">Operacoes</div>
        <button class="btn tiny secondary ops-close" type="button">Fechar</button>
      </div>
      <div class="ops-body">
        <div id="op-search" class="ops-panel">
          <div class="card">
            <div class="cardTitle">Busca</div>
            <div class="grid search-grid">
              <div class="field span-12">
                <label>Tipo</label>
                <div class="segmented">
                  <button type="button" class="seg-btn active" data-kind-toggle data-kind="">Todos</button>
                  <button type="button" class="seg-btn" data-kind-toggle data-kind="nascimento">Nascimento</button>
                  <button type="button" class="seg-btn" data-kind-toggle data-kind="casamento">Casamento</button>
                  <button type="button" class="seg-btn" data-kind-toggle data-kind="obito">Obito</button>
                </div>
                <input type="hidden" id="search-kind" value="" />
              </div>
              <div class="field span-12">
                <label>Busca livre</label>
                <input id="search-q" placeholder="Nome, CPF, matricula, municipio..." />
              </div>
              <div class="field span-6">
                <label>Nome</label>
                <input id="search-nome" />
              </div>
              <div class="field span-6">
                <label>Nome da mae</label>
                <input id="search-mae" />
              </div>
              <div class="field span-4">
                <label>CPF</label>
                <input id="search-cpf" inputmode="numeric" />
              </div>
              <div class="field span-4">
                <label>Termo</label>
                <input id="search-termo" inputmode="numeric" />
              </div>
            </div>
            <div class="toolbar-left" style="margin-top: 10px;">
              <button id="btn-search" class="btn secondary" type="button">Buscar</button>
            </div>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>

        <div id="op-actions" class="ops-panel">
          <div class="card">
            <div class="cardTitle">Acoes</div>
            <div class="action-status">
              <div class="action-row">
                <span class="label">JSON em memoria</span>
                <span id="status-json" class="badge">â€”</span>
              </div>
              <div class="action-row">
                <span class="label">XML gerado</span>
                <span id="status-xml" class="badge">â€”</span>
              </div>
              <div class="action-row">
                <span class="label">PostgreSQL</span>
                <span id="status-db" class="badge">NAO</span>
              </div>
            </div>
            <div class="toolbar-left" style="margin-top: 10px;">
              <button id="actions-save" class="btn save" type="button">Salvar</button>
              <button id="actions-export-json" class="btn secondary" type="button">Exportar JSON</button>
              <button id="actions-export-xml" class="btn secondary" type="button">Baixar XML</button>
              <button id="actions-export-pdf" class="btn secondary" type="button">PDF</button>
            </div>
            <div class="action-hints">
              <span class="badge">Ctrl+Espaco: JSON</span>
              <span class="badge">Ctrl+Alt+P: PDF</span>
            </div>
            <div id="actions-status" class="import-status"></div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Drawer (consistente com Nascimento/Casamento) -->
  <div id="drawer-slot"></div>

<script type="module" src="../js/obito.bundle.js"></script>
  <script>
    (function(){
      try{
        const sel = document.getElementById('ato-select');
        if (!sel) return;
        sel.addEventListener('change', ()=>{
          try{
            const map = { nascimento: './Nascimento2Via.html', casamento: './Casamento2Via.html', obito: './Obito2Via.html' };
            const next = map[sel.value];
            if (next) {
              window.dispatchEvent(new CustomEvent('app:navigate', { detail: { href: next } }));
            }
          }catch(e){}
        });
      }catch(e){}
    })();
  </script>
</body>
</html>

